<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dungeonaut - Speedrun RPG</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- Login/Register Screen -->
        <div id="login-screen" class="screen active">
            <div class="glass-panel login-panel">
                <h1 class="title">‚öîÔ∏è DUNGEONAUT ‚öîÔ∏è</h1>
                <p class="subtitle">Login or Create Account</p>

                <!-- Auth Status -->
                <div id="auth-user-display" class="auth-status">Not logged in</div>

                <!-- Tab Switcher -->
                <div class="auth-tabs">
                    <button class="auth-tab active" onclick="game.switchAuthTab('login')">Login</button>
                    <button class="auth-tab" onclick="game.switchAuthTab('register')">Register</button>
                </div>

                <!-- Login Form -->
                <div id="login-form" class="auth-form active">
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="login-email" placeholder="your@email.com" autocomplete="email">
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="login-password" placeholder="Password" autocomplete="current-password">
                    </div>
                    <button class="btn btn-primary" onclick="game.handleLogin()">Login</button>
                </div>

                <!-- Register Form -->
                <div id="register-form" class="auth-form">
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" id="register-username" placeholder="Your username" autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="register-email" placeholder="your@email.com" autocomplete="email">
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="register-password" placeholder="Password (min 6 chars)" autocomplete="new-password">
                    </div>
                    <div class="form-group">
                        <label>Confirm Password</label>
                        <input type="password" id="register-password-confirm" placeholder="Confirm password" autocomplete="new-password">
                    </div>
                    <button class="btn btn-primary" onclick="game.handleRegister()">Create Account</button>
                </div>

                <!-- Guest Mode -->
                <div class="auth-divider">
                    <span>OR</span>
                </div>
                <button class="btn btn-secondary" onclick="game.authSystem.playAsGuest()">
                    Play as Guest (Local saves only)
                </button>

                <!-- Firebase Notice -->
                <div class="auth-notice">
                    <small>üì± Account required to sync stats across devices</small>
                </div>
            </div>
        </div>

        <!-- Main Menu -->
        <div id="menu-screen" class="screen">
            <div class="glass-panel main-menu">
                <h1 class="title">‚öîÔ∏è DUNGEONAUT ‚öîÔ∏è</h1>
                <p class="subtitle">Master the Dungeon. Break the Clock.</p>

                <!-- Auth Info in Main Menu -->
                <div class="menu-auth-info">
                    <div id="menu-auth-user" class="auth-status-small">Not logged in</div>
                    <button id="auth-login-btn" class="btn-small" onclick="game.authSystem.showLoginScreen()">Login</button>
                    <button id="auth-logout-btn" class="btn-small" onclick="game.authSystem.logout()" style="display: none;">Logout</button>
                </div>

                <div class="daily-info">
                    <div class="info-item">
                        <span class="label">Daily Seed:</span>
                        <span id="daily-seed" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Today's Modifier:</span>
                        <span id="daily-modifier" class="value">-</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Stamina:</span>
                        <span id="stamina-display" class="value">5/5</span>
                    </div>
                </div>

                <!-- Player Progression Display -->
                <div class="player-progression-summary glass-panel-mini">
                    <div class="progression-header">
                        <div class="player-level">
                            <span class="level-icon">‚≠ê</span>
                            <span id="player-level-display">Level 1</span>
                        </div>
                        <div class="player-class">
                            <span id="player-class-display">Novice</span>
                        </div>
                    </div>
                    <div class="xp-bar-container">
                        <div class="xp-bar-fill" id="xp-bar-fill" style="width: 0%"></div>
                        <span class="xp-bar-text" id="xp-bar-text">0 / 100 XP</span>
                    </div>
                    <button class="btn-progression" onclick="game.showProgression()">
                        üìä View Progression
                    </button>
                </div>

                <div class="menu-buttons">
                    <button class="btn btn-primary" onclick="game.showPlanningScreen()">
                        <span class="btn-icon">üéØ</span>
                        Start Run
                    </button>
                    <img src="images/pvpButton.png" alt="PvP Arena" class="menu-image-btn" onclick="game.showPvPLobby()">
                    <button class="btn btn-secondary" onclick="game.invasionSystem.showInvasionMenu()">
                        <span class="btn-icon">‚öîÔ∏è</span>
                        Invasion Mode
                    </button>
                    <img src="images/leaderboards.png" alt="Leaderboards" class="menu-image-btn" onclick="game.showLeaderboard()">
                    <button class="btn btn-secondary" onclick="game.showGhostStats()">
                        <span class="btn-icon">üëª</span>
                        Ghost Stats
                    </button>
                    <button class="btn btn-secondary" onclick="game.showSettings()">
                        <span class="btn-icon">‚öôÔ∏è</span>
                        Settings
                    </button>
                    <button class="btn btn-secondary" onclick="game.showFeedback()">
                        <span class="btn-icon">üí¨</span>
                        Send Feedback
                    </button>
                    <button class="btn btn-secondary" id="admin-menu-btn" onclick="game.adminSystem.showAdminDashboard()" style="display: none;">
                        <span class="btn-icon">üîê</span>
                        Admin Panel
                    </button>
                </div>
            </div>
        </div>

        <!-- Planning Screen -->
        <div id="planning-screen" class="screen">
            <div class="glass-panel planning-panel">
                <h2>Pre-Run Planning</h2>

                <div class="planning-sections">
                    <!-- Stats Allocation -->
                    <div class="section">
                        <h3>üìä Stat Allocation (10 points)</h3>
                        <div class="stat-controls">
                            <div class="stat-row">
                                <label>Strength (Damage)</label>
                                <button onclick="game.adjustStat('strength', -1)">-</button>
                                <span id="stat-strength">3</span>
                                <button onclick="game.adjustStat('strength', 1)">+</button>
                            </div>
                            <div class="stat-row">
                                <label>Vitality (HP)</label>
                                <button onclick="game.adjustStat('vitality', -1)">-</button>
                                <span id="stat-vitality">3</span>
                                <button onclick="game.adjustStat('vitality', 1)">+</button>
                            </div>
                            <div class="stat-row">
                                <label>Agility (Speed)</label>
                                <button onclick="game.adjustStat('agility', -1)">-</button>
                                <span id="stat-agility">2</span>
                                <button onclick="game.adjustStat('agility', 1)">+</button>
                            </div>
                            <div class="stat-row">
                                <label>Luck (Crit Chance)</label>
                                <button onclick="game.adjustStat('luck', -1)">-</button>
                                <span id="stat-luck">2</span>
                                <button onclick="game.adjustStat('luck', 1)">+</button>
                            </div>
                        </div>
                        <div class="stat-summary">
                            Points Remaining: <span id="points-remaining">0</span>
                        </div>
                    </div>

                    <!-- Gear Selection -->
                    <div class="section">
                        <h3>‚öîÔ∏è Gear Loadout</h3>
                        <div class="gear-grid" id="gear-selection">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Skill Selection -->
                    <div class="section">
                        <h3>‚ú® Skills (Choose 3)</h3>
                        <div class="skill-grid" id="skill-selection">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <div class="planning-actions">
                    <button class="btn btn-secondary" onclick="game.showMainMenu()">Back</button>
                    <button class="btn btn-primary" onclick="game.startRun()" id="start-run-btn">Begin Run</button>
                </div>
            </div>
        </div>

        <!-- Dungeon Run Screen -->
        <div id="dungeon-screen" class="screen">
            <div class="dungeon-container">
                <!-- HUD -->
                <div class="hud glass-panel">
                    <div class="hud-section">
                        <div class="timer">
                            <span class="label">Time:</span>
                            <span id="run-timer" class="value timer-value">00:00.0</span>
                        </div>
                    </div>
                    <div class="hud-section">
                        <div class="hp-bar">
                            <span class="label">HP:</span>
                            <div class="bar-container">
                                <div id="hp-bar-fill" class="bar-fill hp-fill" style="width: 100%"></div>
                                <span id="hp-text" class="bar-text">100/100</span>
                            </div>
                        </div>
                    </div>
                    <div class="hud-section">
                        <span class="label">Room:</span>
                        <span id="room-counter" class="value">1/10</span>
                    </div>
                    <div class="hud-section">
                        <span class="label">Deaths:</span>
                        <span id="death-counter" class="value">0</span>
                    </div>
                </div>

                <!-- Main Dungeon Area -->
                <div class="dungeon-main">
                    <div class="room-display glass-panel">
                        <h3 id="room-title">Combat Room</h3>
                        <div id="room-content" class="room-content">
                            <!-- Room content populated by JS -->
                        </div>

                        <!-- Combat Log -->
                        <div class="combat-log" id="combat-log">
                            <!-- Combat events appear here -->
                        </div>
                    </div>

                    <!-- Skills Bar -->
                    <div class="skills-bar glass-panel">
                        <div id="active-skills" class="active-skills">
                            <!-- Skills populated by JS -->
                        </div>
                    </div>

                    <!-- Room Navigation -->
                    <div class="room-navigation" id="room-navigation">
                        <!-- Navigation options populated by JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="screen">
            <div class="glass-panel results-panel">
                <h2 id="results-title">Run Complete!</h2>

                <div class="results-breakdown">
                    <div class="result-row major">
                        <span>Final Time:</span>
                        <span id="final-time" class="highlight">00:00.0</span>
                    </div>
                    <div class="result-row">
                        <span>Base Time:</span>
                        <span id="base-time">00:00.0</span>
                    </div>
                    <div class="result-row">
                        <span>Combat Time:</span>
                        <span id="combat-time">00:00.0</span>
                    </div>
                    <div class="result-row penalty">
                        <span>Death Penalties:</span>
                        <span id="death-penalty">+00:00.0</span>
                    </div>
                    <div class="result-row penalty">
                        <span>Gear Break Penalties:</span>
                        <span id="gear-penalty">+00:00.0</span>
                    </div>
                    <div class="result-row bonus">
                        <span>Speed Bonuses:</span>
                        <span id="speed-bonus">-00:00.0</span>
                    </div>
                    <div class="result-row">
                        <span>Perfect Clears:</span>
                        <span id="perfect-clears">0</span>
                    </div>
                </div>

                <div id="leaderboard-position" class="leaderboard-position">
                    <!-- Populated by JS -->
                </div>

                <div class="results-actions">
                    <button class="btn btn-secondary" onclick="game.showLeaderboard()">View Leaderboard</button>
                    <button class="btn btn-primary" onclick="game.showMainMenu()">Main Menu</button>
                </div>
            </div>
        </div>

        <!-- Leaderboard Screen -->
        <div id="leaderboard-screen" class="screen">
            <div class="glass-panel leaderboard-panel">
                <h2>üèÜ Leaderboards</h2>

                <div class="leaderboard-tabs">
                    <button class="tab-btn active" onclick="game.switchLeaderboard('daily')">Daily</button>
                    <button class="tab-btn" onclick="game.switchLeaderboard('weekly')">Weekly</button>
                    <button class="tab-btn" onclick="game.switchLeaderboard('alltime')">All-Time</button>
                </div>

                <div class="leaderboard-content">
                    <table class="leaderboard-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Player</th>
                                <th>Time</th>
                                <th>Deaths</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody id="leaderboard-body">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>

                <div class="leaderboard-actions">
                    <button class="btn btn-secondary" onclick="game.showMainMenu()">Back</button>
                </div>
            </div>
        </div>

        <!-- Ghost Stats Screen -->
        <div id="ghost-screen" class="screen">
            <div class="glass-panel ghost-panel">
                <h2>üëª Ghost Stats - Top Run Analysis</h2>

                <div id="ghost-content" class="ghost-content">
                    <!-- Populated by JS -->
                </div>

                <div class="ghost-actions">
                    <button class="btn btn-secondary" onclick="game.showMainMenu()">Back</button>
                </div>
            </div>
        </div>

        <!-- PvP Lobby Screen -->
        <div id="pvp-lobby-screen" class="screen">
            <div class="glass-panel pvp-lobby-panel">
                <h2>‚öîÔ∏è PvP Arena</h2>
                <p class="subtitle">Tactical Turn-Based Combat</p>

                <!-- Multiplayer Status -->
                <div class="multiplayer-status" id="multiplayer-status">
                    <span id="connection-status">Connecting...</span>
                    <span id="username-display"></span>
                    <button class="btn-small" onclick="game.changeUsername()" style="margin-left: 10px;">Change Name</button>
                </div>

                <!-- Team Size Selection -->
                <div class="pvp-team-selection">
                    <h3>Select Team Size</h3>
                    <div class="team-size-options">
                        <button class="team-size-btn active" id="team-size-1v1" onclick="game.selectTeamSize('1v1')">
                            <div class="team-size-icon">‚öîÔ∏è</div>
                            <div class="team-size-name">1v1</div>
                        </button>
                        <button class="team-size-btn" id="team-size-2v2" onclick="game.selectTeamSize('2v2')">
                            <div class="team-size-icon">üë•</div>
                            <div class="team-size-name">2v2</div>
                        </button>
                        <button class="team-size-btn" id="team-size-3v3" onclick="game.selectTeamSize('3v3')">
                            <div class="team-size-icon">üë•üë•</div>
                            <div class="team-size-name">3v3</div>
                        </button>
                    </div>
                </div>

                <div class="pvp-mode-selection">
                    <h3>Select Battle Mode</h3>
                    <div class="mode-options">
                        <div class="mode-card" onclick="game.selectPvPMode('online-ranked')">
                            <div class="mode-icon">üåê</div>
                            <div class="mode-name">Online Ranked</div>
                            <div class="mode-desc">Battle real players for ranking</div>
                        </div>
                        <div class="mode-card" onclick="game.selectPvPMode('online-unranked')">
                            <div class="mode-icon">üéÆ</div>
                            <div class="mode-name">Online Casual</div>
                            <div class="mode-desc">Practice against real opponents</div>
                        </div>
                        <div class="mode-card" onclick="game.selectPvPMode('ranked')">
                            <div class="mode-icon">üèÜ</div>
                            <div class="mode-name">VS AI (Ranked)</div>
                            <div class="mode-desc">Train against AI opponents</div>
                        </div>
                        <div class="mode-card" onclick="game.selectPvPMode('practice')">
                            <div class="mode-icon">üéØ</div>
                            <div class="mode-name">VS AI (Practice)</div>
                            <div class="mode-desc">Test builds with no pressure</div>
                        </div>
                    </div>
                </div>

                <div class="pvp-stats" id="pvp-stats">
                    <h3>Your Arena Stats</h3>
                    <div class="stat-grid">
                        <div class="stat-item">
                            <span class="label">Wins:</span>
                            <span id="pvp-wins" class="value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="label">Losses:</span>
                            <span id="pvp-losses" class="value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="label">Win Rate:</span>
                            <span id="pvp-winrate" class="value">0%</span>
                        </div>
                    </div>
                </div>

                <div class="pvp-lobby-actions">
                    <button class="btn btn-secondary" onclick="game.showArenaStats()">üìä View Full Stats & Achievements</button>
                    <button class="btn btn-secondary" onclick="game.showMainMenu()">Back</button>
                </div>
            </div>
        </div>

        <!-- Arena Stats & Achievements Screen -->
        <div id="arena-stats-screen" class="screen">
            <div class="glass-panel arena-stats-panel">
                <h2>üìä Arena Statistics & Achievements</h2>

                <div class="arena-content">
                    <!-- Overall Stats -->
                    <div class="section">
                        <h3>üèÜ Career Stats</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-label">Total Matches</div>
                                <div class="stat-value" id="stat-total-matches">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Wins</div>
                                <div class="stat-value wins" id="stat-wins">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Losses</div>
                                <div class="stat-value losses" id="stat-losses">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Draws</div>
                                <div class="stat-value" id="stat-draws">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Win Rate</div>
                                <div class="stat-value" id="stat-winrate">0%</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Best Win Streak</div>
                                <div class="stat-value streak" id="stat-best-streak">0</div>
                            </div>
                        </div>
                    </div>

                    <!-- Combat Stats -->
                    <div class="section">
                        <h3>‚öîÔ∏è Combat Stats</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-label">Total Damage Dealt</div>
                                <div class="stat-value" id="stat-total-damage">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Total Damage Taken</div>
                                <div class="stat-value" id="stat-total-taken">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Total Healing</div>
                                <div class="stat-value heal" id="stat-total-healing">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Total Crits</div>
                                <div class="stat-value crit" id="stat-total-crits">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Highest Damage (Single Match)</div>
                                <div class="stat-value highlight" id="stat-highest-damage">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Most Damage Taken (Single Match)</div>
                                <div class="stat-value" id="stat-highest-taken">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Longest Match</div>
                                <div class="stat-value" id="stat-longest-match">0 turns</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Shortest Win</div>
                                <div class="stat-value" id="stat-shortest-win">0 turns</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Most Used Skill</div>
                                <div class="stat-value" id="stat-most-used-skill">None</div>
                            </div>
                        </div>
                    </div>

                    <!-- Achievements -->
                    <div class="section">
                        <h3>üèÖ Achievements</h3>
                        <div class="achievement-filters">
                            <button class="filter-btn active" data-filter="all" onclick="game.filterAchievements('all')">
                                All
                            </button>
                            <button class="filter-btn" data-filter="unlocked" onclick="game.filterAchievements('unlocked')">
                                Unlocked
                            </button>
                            <button class="filter-btn" data-filter="locked" onclick="game.filterAchievements('locked')">
                                Locked
                            </button>
                        </div>
                        <div id="achievements-grid" class="achievements-grid">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <div class="arena-stats-actions">
                    <button class="btn btn-secondary" onclick="game.showPvPLobby()">Back to Arena</button>
                </div>
            </div>
        </div>

        <!-- Matchmaking Screen -->
        <div id="matchmaking-screen" class="screen">
            <div class="glass-panel matchmaking-panel">
                <h2>üîç Finding Opponent...</h2>
                <div class="matchmaking-spinner">
                    <div class="spinner"></div>
                </div>
                <p id="matchmaking-status">Searching for players...</p>
                <p class="queue-time">Time in queue: <span id="queue-timer">0:00</span></p>
                <button class="btn btn-secondary" onclick="game.cancelMatchmaking()">Cancel</button>
            </div>
        </div>

        <!-- Match Found Screen -->
        <div id="match-found-screen" class="screen">
            <div class="glass-panel match-found-panel">
                <h2>‚öîÔ∏è Opponent Found!</h2>
                <div class="opponent-info">
                    <div class="opponent-card">
                        <div class="opponent-icon">üë§</div>
                        <h3 id="opponent-name">Opponent</h3>
                    </div>
                </div>
                <p class="match-message">Prepare for battle!</p>
                <button class="btn btn-primary" onclick="game.proceedToBuild()">Continue</button>
            </div>
        </div>

        <!-- PvP Build Selection Screen -->
        <div id="pvp-build-screen" class="screen">
            <div class="glass-panel pvp-build-panel">
                <h2>Build Your Fighter</h2>

                <div class="pvp-build-sections">
                    <!-- Stats Allocation -->
                    <div class="section">
                        <h3>üìä Stat Allocation (10 points)</h3>
                        <div class="stat-controls">
                            <div class="stat-row">
                                <label>Strength (Damage)</label>
                                <button onclick="game.adjustPvPStat('strength', -1)">-</button>
                                <span id="pvp-stat-strength">0</span>
                                <button onclick="game.adjustPvPStat('strength', 1)">+</button>
                            </div>
                            <div class="stat-row">
                                <label>Vitality (HP)</label>
                                <button onclick="game.adjustPvPStat('vitality', -1)">-</button>
                                <span id="pvp-stat-vitality">0</span>
                                <button onclick="game.adjustPvPStat('vitality', 1)">+</button>
                            </div>
                            <div class="stat-row">
                                <label>Agility (Speed)</label>
                                <button onclick="game.adjustPvPStat('agility', -1)">-</button>
                                <span id="pvp-stat-agility">0</span>
                                <button onclick="game.adjustPvPStat('agility', 1)">+</button>
                            </div>
                            <div class="stat-row">
                                <label>Luck (Crit Chance)</label>
                                <button onclick="game.adjustPvPStat('luck', -1)">-</button>
                                <span id="pvp-stat-luck">0</span>
                                <button onclick="game.adjustPvPStat('luck', 1)">+</button>
                            </div>
                        </div>
                        <div class="stat-summary">
                            Points Remaining: <span id="pvp-points-remaining">10</span>
                        </div>
                    </div>

                    <!-- Loadout Presets -->
                    <div class="section">
                        <h3>üíæ Quick Loadouts</h3>
                        <div class="loadout-buttons">
                            <button class="loadout-btn" onclick="game.loadLoadout(1)">
                                <div class="loadout-icon">üõ°Ô∏è</div>
                                <div class="loadout-name">Tank</div>
                            </button>
                            <button class="loadout-btn" onclick="game.loadLoadout(2)">
                                <div class="loadout-icon">‚öîÔ∏è</div>
                                <div class="loadout-name">DPS</div>
                            </button>
                            <button class="loadout-btn" onclick="game.loadLoadout(3)">
                                <div class="loadout-icon">‚öñÔ∏è</div>
                                <div class="loadout-name">Balanced</div>
                            </button>
                            <button class="loadout-btn" onclick="game.loadLoadout(4)">
                                <div class="loadout-icon">üíö</div>
                                <div class="loadout-name">Support</div>
                            </button>
                            <button class="loadout-btn" onclick="game.loadLoadout(5)">
                                <div class="loadout-icon">üí•</div>
                                <div class="loadout-name">Glass Cannon</div>
                            </button>
                        </div>
                    </div>

                    <!-- Skill Selection -->
                    <div class="section">
                        <h3>‚ú® Skills (Choose 4 for PvP)</h3>
                        <div class="pvp-skill-grid" id="pvp-skill-selection">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <div class="pvp-build-actions">
                    <button class="btn btn-secondary" onclick="game.showPvPLobby()">Back</button>
                    <button class="btn btn-primary" onclick="game.startPvPBattle()" id="start-pvp-btn">Enter Battle</button>
                </div>
            </div>
        </div>

        <!-- PvP Battle Screen -->
        <div id="pvp-battle-screen" class="screen">
            <div class="pvp-battle-container">
                <!-- Battle HUD -->
                <div class="pvp-hud glass-panel">
                    <div class="fighter-display player-display">
                        <div class="fighter-name">You</div>
                        <div class="hp-bar">
                            <div class="bar-container">
                                <div id="pvp-player-hp-fill" class="bar-fill hp-fill" style="width: 100%"></div>
                                <span id="pvp-player-hp-text" class="bar-text">100/100</span>
                            </div>
                        </div>
                        <div id="pvp-player-shield" class="shield-display">üõ°Ô∏è Shield: 0</div>
                        <div id="pvp-player-status" class="status-display"></div>
                    </div>

                    <div class="battle-info">
                        <div class="turn-counter">Turn <span id="pvp-turn">1</span>/‚àû</div>
                        <div class="turn-timer">‚è±Ô∏è <span id="pvp-timer">60</span>s</div>
                        <div class="vs-display">‚öîÔ∏è VS ‚öîÔ∏è</div>
                    </div>

                    <div class="fighter-display opponent-display">
                        <div class="fighter-name">Rival</div>
                        <div class="hp-bar">
                            <div class="bar-container">
                                <div id="pvp-opponent-hp-fill" class="bar-fill hp-fill" style="width: 100%"></div>
                                <span id="pvp-opponent-hp-text" class="bar-text">120/120</span>
                            </div>
                        </div>
                        <div id="pvp-opponent-shield" class="shield-display">üõ°Ô∏è Shield: 0</div>
                        <div id="pvp-opponent-status" class="status-display"></div>
                    </div>
                </div>

                <!-- Battle Log -->
                <div class="pvp-battle-log glass-panel">
                    <h4>Battle Log</h4>
                    <div id="pvp-log" class="log-content">
                        <!-- Battle events appear here -->
                    </div>
                </div>

                <!-- Action Selection -->
                <div class="pvp-actions glass-panel">
                    <h4>Select Your Action</h4>
                    <div class="action-grid">
                        <img src="images/basicAttack.png" alt="Basic Attack" class="action-image-btn" data-action-id="basic_attack" onclick="game.selectPvPAction('basic_attack')">
                        <img src="images/guard.png" alt="Guard" class="action-image-btn" data-action-id="guard" onclick="game.selectPvPAction('guard')">
                    </div>

                    <h4>Skills</h4>
                    <div class="pvp-skill-buttons" id="pvp-active-skills">
                        <!-- Populated by JS -->
                    </div>

                    <div class="pvp-action-confirm">
                        <button class="btn btn-primary" id="pvp-confirm-btn" onclick="game.confirmPvPAction()" disabled>
                            Confirm Action
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- PvP Results Screen -->
        <div id="pvp-results-screen" class="screen">
            <div class="glass-panel pvp-results-panel">
                <h2 id="pvp-result-title">Victory!</h2>

                <div class="pvp-results-content">
                    <div class="result-summary">
                        <div class="result-stat">
                            <span class="label">Battle Duration:</span>
                            <span id="pvp-battle-turns" class="value">10 turns</span>
                        </div>
                        <div class="result-stat">
                            <span class="label">Damage Dealt:</span>
                            <span id="pvp-damage-dealt" class="value">450</span>
                        </div>
                        <div class="result-stat">
                            <span class="label">Damage Taken:</span>
                            <span id="pvp-damage-taken" class="value">280</span>
                        </div>
                        <div class="result-stat">
                            <span class="label">Healing Done:</span>
                            <span id="pvp-healing-done" class="value">0</span>
                        </div>
                    </div>

                    <div id="pvp-rank-change" class="rank-change">
                        <!-- Populated by JS -->
                    </div>

                    <div class="battle-log-section">
                        <h3>üìú Battle Log</h3>
                        <div id="pvp-full-battle-log" class="full-battle-log">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <div class="pvp-results-actions">
                    <button class="btn btn-secondary" onclick="game.showPvPLobby()">Back to Lobby</button>
                    <button class="btn btn-primary" onclick="game.selectPvPMode(game.pvpSystem.currentMatch?.isRanked ? 'ranked' : 'practice')">Battle Again</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Player Progression Screen -->
    <div id="progression-screen" class="screen">
        <div class="glass-panel progression-panel">
            <h2>‚≠ê Player Progression</h2>

            <!-- Level & XP Summary -->
            <div class="progression-summary">
                <div class="level-display-large">
                    <div class="level-number" id="progression-level">1</div>
                    <div class="level-label">Level</div>
                </div>
                <div class="xp-progress-section">
                    <div class="xp-progress-bar">
                        <div class="xp-progress-fill" id="progression-xp-fill" style="width: 0%"></div>
                        <span class="xp-progress-text" id="progression-xp-text">0 / 100 XP</span>
                    </div>
                    <div class="xp-stats">
                        <span>Total XP: <strong id="total-xp">0</strong></span>
                        <span>Next Level: <strong id="xp-to-next">100 XP</strong></span>
                    </div>
                </div>
            </div>

            <!-- Class Selection -->
            <div class="progression-section">
                <h3>üé≠ Class Selection</h3>
                <p class="section-subtitle">Choose your playstyle (Unlocks at Level 5)</p>
                <div class="class-grid" id="class-selection-grid">
                    <!-- Populated by JS -->
                </div>
            </div>

            <!-- Skill Unlocks -->
            <div class="progression-section">
                <h3>‚ú® Skill Unlocks</h3>
                <p class="section-subtitle">Unlock new abilities as you level up</p>
                <div class="unlock-grid" id="skill-unlocks-grid">
                    <!-- Populated by JS -->
                </div>
            </div>

            <!-- Perk Tree -->
            <div class="progression-section">
                <h3>üåü Perks & Talents</h3>
                <p class="section-subtitle">Permanent bonuses - Perk Points: <strong id="perk-points">0</strong></p>
                <div class="perk-tree" id="perk-tree">
                    <!-- Populated by JS -->
                </div>
            </div>

            <!-- Titles & Cosmetics -->
            <div class="progression-section">
                <h3>üëë Titles & Achievements</h3>
                <p class="section-subtitle">Show off your accomplishments</p>
                <div class="title-grid" id="title-grid">
                    <!-- Populated by JS -->
                </div>
            </div>

            <div class="progression-actions">
                <button class="btn btn-secondary" onclick="game.showMainMenu()">Back to Menu</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-overlay" onclick="game.closeSettings()"></div>
        <div class="modal-content settings-modal-content">
            <div class="modal-header">
                <h2>‚öôÔ∏è Settings</h2>
                <button class="modal-close" onclick="game.closeSettings()">‚úï</button>
            </div>

            <div class="modal-body">
                <!-- Audio Settings -->
                <div class="settings-section">
                    <h3>üîä Audio</h3>
                    <div class="setting-item">
                        <label for="master-volume">Master Volume</label>
                        <div class="volume-control">
                            <input type="range" id="master-volume" min="0" max="100" value="70" oninput="game.audioSystem.setMasterVolume(this.value)">
                            <span id="master-volume-value">70%</span>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label for="music-volume">Music Volume</label>
                        <div class="volume-control">
                            <input type="range" id="music-volume" min="0" max="100" value="50" oninput="game.audioSystem.setMusicVolume(this.value)">
                            <span id="music-volume-value">50%</span>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label for="sfx-volume">Sound Effects</label>
                        <div class="volume-control">
                            <input type="range" id="sfx-volume" min="0" max="100" value="70" oninput="game.audioSystem.setSFXVolume(this.value)">
                            <span id="sfx-volume-value">70%</span>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label>Background Music</label>
                        <button class="btn btn-secondary" id="music-toggle" onclick="game.audioSystem.toggleMusic()">
                            <span id="music-status">‚ñ∂Ô∏è Play</span>
                        </button>
                    </div>
                </div>

                <!-- Display Settings -->
                <div class="settings-section">
                    <h3>üñ•Ô∏è Display</h3>
                    <div class="setting-item">
                        <label>Animations</label>
                        <button class="btn btn-secondary toggle-btn" id="toggle-animations" onclick="game.toggleAnimations()">
                            ‚úÖ Enabled
                        </button>
                    </div>
                    <div class="setting-item">
                        <label>Screen Shake</label>
                        <button class="btn btn-secondary toggle-btn" id="toggle-screen-shake" onclick="game.toggleScreenShake()">
                            ‚úÖ Enabled
                        </button>
                    </div>
                </div>

                <!-- Game Settings -->
                <div class="settings-section">
                    <h3>üéÆ Game</h3>
                    <div class="setting-item">
                        <label>Autosave</label>
                        <button class="btn btn-secondary toggle-btn" id="toggle-autosave" onclick="game.toggleAutosave()">
                            ‚úÖ Enabled
                        </button>
                    </div>
                    <div class="setting-item">
                        <label>Combat Tutorial</label>
                        <button class="btn btn-secondary" onclick="game.resetTutorial()">
                            Reset Tutorial
                        </button>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-primary" onclick="game.closeSettings()">Done</button>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedback-modal" class="modal">
        <div class="modal-overlay" onclick="game.closeFeedback()"></div>
        <div class="modal-content feedback-modal-content">
            <div class="modal-header">
                <h2>üí¨ Submit Feedback</h2>
                <button class="modal-close" onclick="game.closeFeedback()">‚úï</button>
            </div>

            <div class="modal-body">
                <div class="feedback-intro">
                    <p>Help us improve Dungeonaut! Submit bug reports, suggestions, or general feedback.</p>
                </div>

                <div class="form-group">
                    <label for="feedback-type">Feedback Type</label>
                    <select id="feedback-type" class="feedback-select">
                        <option value="bug">üêõ Bug Report</option>
                        <option value="feature">‚ú® Feature Request</option>
                        <option value="improvement">üîß Improvement</option>
                        <option value="general">üí≠ General Feedback</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="feedback-title">Title</label>
                    <input type="text" id="feedback-title" placeholder="Brief summary of your feedback" class="feedback-input">
                </div>

                <div class="form-group">
                    <label for="feedback-description">Description</label>
                    <textarea id="feedback-description" rows="6" placeholder="Provide details about your feedback..." class="feedback-textarea"></textarea>
                </div>

                <div class="form-group">
                    <label for="feedback-email">Email (Optional)</label>
                    <input type="email" id="feedback-email" placeholder="your@email.com (if you want a response)" class="feedback-input">
                </div>

                <div id="feedback-status" class="feedback-status"></div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="game.closeFeedback()">Cancel</button>
                <button class="btn btn-primary" onclick="game.submitFeedback()">Submit Feedback</button>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard Screen -->
    <div id="admin-dashboard-screen" class="screen">
        <div class="glass-panel admin-dashboard-panel">
            <div id="admin-dashboard-content">
                <!-- Populated by admin.js -->
            </div>
        </div>
    </div>

    <!-- Invasion Menu Screen -->
    <div id="invasion-menu-screen" class="screen">
        <div class="glass-panel invasion-menu-panel">
            <h2>‚öîÔ∏è Invasion Mode</h2>
            <p class="subtitle">Turn-based strategy combat - Build your squad with 1000 points</p>

            <!-- Points Display - Centered at top -->
            <div class="invasion-points-display">
                <div class="points-box">
                    <div class="points-label">Squad Resources</div>
                    <div class="points-value" id="invasion-points-remaining">1000 / 1000</div>
                </div>
            </div>

            <!-- Two Column Layout: Commands Left, Units Right -->
            <div class="invasion-menu-content">
                <!-- Left Column: Commands -->
                <div class="invasion-column invasion-commands-column">
                    <h3>Available Commands</h3>
                    <div id="invasion-command-shop" class="invasion-shop-container"></div>
                </div>

                <!-- Right Column: Units -->
                <div class="invasion-column invasion-units-column">
                    <h3>Available Units</h3>
                    <div id="invasion-unit-shop" class="invasion-shop-container"></div>
                </div>
            </div>

            <!-- Horizontal Action Buttons -->
            <div class="invasion-menu-actions">
                <button class="btn btn-secondary" onclick="game.invasionSystem.clearAll()">Clear All</button>
                <button class="btn btn-secondary" onclick="game.invasionSystem.showFormationEditor()">Set Formation</button>
                <button class="btn btn-primary" onclick="game.invasionSystem.showMatchmaking()">Find Match</button>
                <button class="btn btn-secondary" onclick="game.invasionSystem.exitInvasionMode()">Back</button>
            </div>
        </div>
    </div>

    <!-- Invasion Formation Editor -->
    <div id="invasion-formation-screen" class="screen">
        <div class="glass-panel invasion-formation-panel">
            <h2>üìã Formation Editor</h2>
            <p class="subtitle">Place your units in the first 3 rows (your side)</p>

            <div id="invasion-formation-board"></div>

            <div class="invasion-formation-actions">
                <button class="btn btn-secondary" onclick="game.invasionSystem.clearFormation()">Clear Formation</button>
                <button class="btn btn-primary" onclick="game.invasionSystem.showInvasionMenu()">Done</button>
            </div>
        </div>
    </div>

    <!-- Invasion Matchmaking Screen -->
    <div id="invasion-matchmaking-screen" class="screen">
        <div class="glass-panel matchmaking-panel">
            <h2>üîç Finding Match...</h2>

            <div class="matchmaking-spinner">
                <div class="spinner"></div>
            </div>

            <p id="invasion-matchmaking-status" class="matchmaking-status">Searching for opponent...</p>

            <div class="matchmaking-actions">
                <button class="btn btn-secondary" onclick="game.invasionSystem.cancelMatchmaking()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Invasion Game Screen -->
    <div id="invasion-game-screen" class="screen">
        <div class="invasion-game-layout">
            <!-- Left Panel: Player Info & Commands -->
            <div class="invasion-left-panel">
                <div class="invasion-player-info glass-panel">
                    <h3 id="invasion-player-name">You</h3>
                    <div class="player-stats">
                        <div class="stat-row">
                            <span>Turn:</span>
                            <span id="invasion-turn-counter">1</span>
                        </div>
                        <div class="stat-row">
                            <span>CP:</span>
                            <span id="invasion-command-points">25</span>
                        </div>
                        <div class="stat-row">
                            <span>Units:</span>
                            <span id="invasion-player-units">0</span>
                        </div>
                    </div>
                </div>

                <div class="invasion-commands-panel glass-panel">
                    <h3>Commands</h3>
                    <div id="invasion-commands-list"></div>
                </div>

                <div class="invasion-actions-panel glass-panel">
                    <button class="btn btn-primary" id="invasion-end-turn-btn" onclick="game.invasionSystem.endTurn()">End Turn</button>
                    <button class="btn btn-secondary" onclick="game.invasionSystem.forfeit()">Forfeit</button>
                </div>
            </div>

            <!-- Center: Game Board -->
            <div class="invasion-board-container">
                <div class="invasion-opponent-info">
                    <span id="invasion-opponent-name">AI Opponent</span>
                    <span id="invasion-opponent-units">0 units</span>
                </div>
                <div id="invasion-game-board" class="invasion-chess-board"></div>
                <div class="invasion-player-indicator">
                    <span>Your Side</span>
                </div>
            </div>

            <!-- Right Panel: Battle Log -->
            <div class="invasion-right-panel">
                <div class="invasion-log-panel glass-panel">
                    <h3>Battle Log</h3>
                    <div id="invasion-battle-log" class="invasion-log-content"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Background Music -->
    <audio id="background-music" loop>
        <source src="music/Track 4 - A dramatic song, with ambient style, for a Videogame.wav" type="audio/wav">
    </audio>

    <!-- Firebase SDKs (compat version for v8 API) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Game scripts -->
    <script src="auth.js?v=17"></script>
    <script src="admin.js?v=17"></script>
    <script src="progression.js?v=17"></script>
    <script src="audio.js?v=17"></script>
    <script src="invasion.js?v=17"></script>
    <script src="pvp.js?v=17"></script>
    <script src="multiplayer.js?v=16"></script>
    <script src="game.js?v=16"></script>
    <link rel="stylesheet" href="styles.css?v=16">
</body>
</html>
